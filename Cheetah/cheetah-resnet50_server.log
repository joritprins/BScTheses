Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 581287
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomConv #1 called N=1, H=230, W=230, CI=3, FH=7, FW=7, CO=64, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [1.263] sent [49.695] MB
~ 1.263 conv
Maxpool 1 called N=1, H=56, W=56, C=64, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 6.504
~ 6.504 maxpool
Truncate #1 on 200704 points by 12 bits
HomBN #1 on shape [64, 56, 56]
Time in sec for current BN = [0.096] sent [3.09822] MB
~ 0.096 BN
Relu #1 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.469
~ 0.469 relu
HomConv #2 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.615] sent [12.3933] MB
~ 0.615 conv
HomConv #3 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.286] sent [3.09878] MB
~ 0.286 conv
Relu #3 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.498
~ 0.498 relu
HomConv #4 called N=1, H=56, W=56, CI=64, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.734] sent [3.10359] MB
~ 0.734 conv
Relu #5 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.554
~ 0.554 relu
HomConv #5 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.588] sent [12.3933] MB
~ 0.588 conv
Truncate #2 on 802816 points by 12 bits
HomBN #2 on shape [256, 56, 56]
Time in sec for current BN = [0.347] sent [12.3933] MB
~ 0.347 BN
Relu #7 on 802816 points, truncate=1 by 12 bits
Time in sec for current relu = 5.156
~ 5.156 relu
HomConv #6 called N=1, H=56, W=56, CI=256, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.627] sent [3.09855] MB
~ 0.627 conv
Relu #9 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.507
~ 0.507 relu
HomConv #7 called N=1, H=56, W=56, CI=64, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.765] sent [3.10333] MB
~ 0.765 conv
Relu #11 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.554
~ 0.554 relu
HomConv #8 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.617] sent [12.3934] MB
~ 0.617 conv
Truncate #3 on 802816 points by 12 bits
HomBN #3 on shape [256, 56, 56]
Time in sec for current BN = [0.356] sent [12.3938] MB
~ 0.356 BN
Relu #13 on 802816 points, truncate=1 by 12 bits
Time in sec for current relu = 8.339
~ 8.339 relu
HomConv #9 called N=1, H=56, W=56, CI=256, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.641] sent [3.09834] MB
~ 0.641 conv
Relu #15 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 3.807
~ 3.807 relu
HomConv #10 called N=1, H=56, W=56, CI=64, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.749] sent [3.10321] MB
~ 0.749 conv
Relu #17 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.569
~ 0.569 relu
HomConv #11 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.587] sent [12.3928] MB
~ 0.587 conv
Truncate #4 on 802816 points by 12 bits
HomBN #4 on shape [256, 56, 56]
Time in sec for current BN = [0.349] sent [12.3926] MB
~ 0.349 BN
Relu #19 on 802816 points, truncate=1 by 12 bits
Time in sec for current relu = 5.2
~ 5.2 relu
HomConv #12 called N=1, H=56, W=56, CI=256, FH=1, FW=1, CO=512, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [4.471] sent [17.3607] MB
~ 4.471 conv
HomConv #13 called N=1, H=56, W=56, CI=256, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [1.238] sent [6.19698] MB
~ 1.238 conv
Relu #21 on 401408 points, truncate=1 by 12 bits
Time in sec for current relu = 0.98
~ 0.98 relu
HomConv #14 called N=1, H=58, W=58, CI=128, FH=3, FW=3, CO=128, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.806] sent [6.20713] MB
~ 2.806 conv
Relu #23 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 3.605
~ 3.605 relu
HomConv #15 called N=1, H=28, W=28, CI=128, FH=1, FW=1, CO=512, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.239] sent [17.3595] MB
~ 2.239 conv
Truncate #5 on 401408 points by 12 bits
HomBN #1 via element-wise mult on 401408 points
Relu #25 on 401408 points, truncate=1 by 12 bits
Time in sec for current relu = 7.352
~ 7.352 relu
HomConv #16 called N=1, H=28, W=28, CI=512, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.156] sent [4.33962] MB
~ 2.156 conv
Relu #27 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.287
~ 0.287 relu
HomConv #17 called N=1, H=28, W=28, CI=128, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.735] sent [4.347] MB
~ 0.735 conv
Truncate #6 on 100352 points by 12 bits
HomBN #2 via element-wise mult on 100352 points
Relu #29 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.234
~ 0.234 relu
HomConv #18 called N=1, H=28, W=28, CI=128, FH=1, FW=1, CO=512, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.326] sent [17.3602] MB
~ 2.326 conv
Truncate #7 on 401408 points by 12 bits
HomBN #3 via element-wise mult on 401408 points
Relu #31 on 401408 points, truncate=1 by 12 bits
Time in sec for current relu = 0.941
~ 0.941 relu
HomConv #19 called N=1, H=28, W=28, CI=512, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.237] sent [4.33986] MB
~ 2.237 conv
Relu #33 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.299
~ 0.299 relu
HomConv #20 called N=1, H=28, W=28, CI=128, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.945] sent [4.3472] MB
~ 0.945 conv
Relu #35 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.293
~ 0.293 relu
HomConv #21 called N=1, H=28, W=28, CI=128, FH=1, FW=1, CO=512, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.341] sent [17.3603] MB
~ 2.341 conv
Truncate #8 on 401408 points by 12 bits
HomBN #4 via element-wise mult on 401408 points
Relu #37 on 401408 points, truncate=1 by 12 bits
Time in sec for current relu = 0.914
~ 0.914 relu
HomConv #22 called N=1, H=28, W=28, CI=512, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.24] sent [4.33983] MB
~ 2.24 conv
Relu #39 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 3.631
~ 3.631 relu
HomConv #23 called N=1, H=28, W=28, CI=128, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.669] sent [4.34733] MB
~ 0.669 conv
Relu #41 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.297
~ 0.297 relu
HomConv #24 called N=1, H=28, W=28, CI=128, FH=1, FW=1, CO=512, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.339] sent [17.3601] MB
~ 2.339 conv
Truncate #9 on 401408 points by 12 bits
HomBN #5 via element-wise mult on 401408 points
Relu #43 on 401408 points, truncate=1 by 12 bits
Time in sec for current relu = 4.182
~ 4.182 relu
HomConv #25 called N=1, H=28, W=28, CI=512, FH=1, FW=1, CO=1024, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [4.583] sent [30.9102] MB
~ 4.583 conv
HomConv #26 called N=1, H=28, W=28, CI=512, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [4.492] sent [8.6804] MB
~ 4.492 conv
Relu #45 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.537
~ 0.537 relu
HomConv #27 called N=1, H=30, W=30, CI=256, FH=3, FW=3, CO=256, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.816] sent [8.69399] MB
~ 2.816 conv
Relu #47 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.366
~ 0.366 relu
HomConv #28 called N=1, H=14, W=14, CI=256, FH=1, FW=1, CO=1024, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.464] sent [30.9112] MB
~ 2.464 conv
Truncate #10 on 200704 points by 12 bits
HomBN #6 via element-wise mult on 200704 points
Relu #49 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 3.693
~ 3.693 relu
HomConv #29 called N=1, H=14, W=14, CI=1024, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.263] sent [7.72785] MB
~ 2.263 conv
Relu #51 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.188
~ 0.188 relu
HomConv #30 called N=1, H=14, W=14, CI=256, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.78] sent [7.73311] MB
~ 0.78 conv
Relu #53 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.251
~ 0.251 relu
HomConv #31 called N=1, H=14, W=14, CI=256, FH=1, FW=1, CO=1024, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.466] sent [30.9107] MB
~ 2.466 conv
Truncate #11 on 200704 points by 12 bits
HomBN #7 via element-wise mult on 200704 points
Relu #55 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.446
~ 0.446 relu
HomConv #32 called N=1, H=14, W=14, CI=1024, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.393] sent [7.72748] MB
~ 2.393 conv
Relu #57 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.271
~ 0.271 relu
HomConv #33 called N=1, H=14, W=14, CI=256, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.79] sent [7.73326] MB
~ 0.79 conv
Relu #59 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.38
~ 0.38 relu
HomConv #34 called N=1, H=14, W=14, CI=256, FH=1, FW=1, CO=1024, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.374] sent [30.9114] MB
~ 2.374 conv
Truncate #12 on 200704 points by 12 bits
HomBN #8 via element-wise mult on 200704 points
Relu #61 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.494
~ 0.494 relu
HomConv #35 called N=1, H=14, W=14, CI=1024, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.19] sent [7.72735] MB
~ 2.19 conv
Relu #63 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.26
~ 0.26 relu
HomConv #36 called N=1, H=14, W=14, CI=256, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.79] sent [7.73349] MB
~ 0.79 conv
Relu #65 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.369
~ 0.369 relu
HomConv #37 called N=1, H=14, W=14, CI=256, FH=1, FW=1, CO=1024, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.533] sent [30.9101] MB
~ 2.533 conv
Truncate #13 on 200704 points by 12 bits
HomBN #9 via element-wise mult on 200704 points
Relu #67 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 3.749
~ 3.749 relu
HomConv #38 called N=1, H=14, W=14, CI=1024, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.199] sent [7.72745] MB
~ 2.199 conv
Relu #69 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.255
~ 0.255 relu
HomConv #39 called N=1, H=14, W=14, CI=256, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.773] sent [7.73339] MB
~ 0.773 conv
Relu #71 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.297
~ 0.297 relu
HomConv #40 called N=1, H=14, W=14, CI=256, FH=1, FW=1, CO=1024, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.462] sent [30.9112] MB
~ 2.462 conv
Truncate #14 on 200704 points by 12 bits
HomBN #10 via element-wise mult on 200704 points
Relu #73 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 3.697
~ 3.697 relu
HomConv #41 called N=1, H=14, W=14, CI=1024, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.256] sent [7.72764] MB
~ 2.256 conv
Relu #75 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.261
~ 0.261 relu
HomConv #42 called N=1, H=14, W=14, CI=256, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.735] sent [7.73329] MB
~ 0.735 conv
Relu #77 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.371
~ 0.371 relu
HomConv #43 called N=1, H=14, W=14, CI=256, FH=1, FW=1, CO=1024, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.465] sent [30.911] MB
~ 2.465 conv
Truncate #15 on 200704 points by 12 bits
HomBN #11 via element-wise mult on 200704 points
Relu #79 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.505
~ 0.505 relu
HomConv #44 called N=1, H=14, W=14, CI=1024, FH=1, FW=1, CO=2048, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [4.967] sent [59.9111] MB
~ 4.967 conv
HomConv #45 called N=1, H=14, W=14, CI=1024, FH=1, FW=1, CO=512, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [4.64] sent [15.4553] MB
~ 4.64 conv
Relu #81 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.353
~ 0.353 relu
HomConv #46 called N=1, H=16, W=16, CI=512, FH=3, FW=3, CO=512, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.918] sent [15.4667] MB
~ 2.918 conv
Relu #83 on 25088 points, truncate=1 by 12 bits
Time in sec for current relu = 0.451
~ 0.451 relu
HomConv #47 called N=1, H=7, W=7, CI=512, FH=1, FW=1, CO=2048, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [3.153] sent [59.9113] MB
~ 3.153 conv
Truncate #16 on 100352 points by 12 bits
HomBN #12 via element-wise mult on 100352 points
Relu #85 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.241
~ 0.241 relu
HomConv #48 called N=1, H=7, W=7, CI=2048, FH=1, FW=1, CO=512, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.242] sent [14.9775] MB
~ 2.242 conv
Relu #87 on 25088 points, truncate=1 by 12 bits
Time in sec for current relu = 0.298
~ 0.298 relu
HomConv #49 called N=1, H=7, W=7, CI=512, FH=3, FW=3, CO=512, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [1.158] sent [14.984] MB
~ 1.158 conv
Relu #89 on 25088 points, truncate=1 by 12 bits
Time in sec for current relu = 0.599
~ 0.599 relu
HomConv #50 called N=1, H=7, W=7, CI=512, FH=1, FW=1, CO=2048, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.94] sent [59.9124] MB
~ 2.94 conv
Truncate #17 on 100352 points by 12 bits
HomBN #13 via element-wise mult on 100352 points
Relu #91 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 3.491
~ 3.491 relu
HomConv #51 called N=1, H=7, W=7, CI=2048, FH=1, FW=1, CO=512, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.263] sent [14.9778] MB
~ 2.263 conv
Relu #93 on 25088 points, truncate=1 by 12 bits
Time in sec for current relu = 0.287
~ 0.287 relu
HomConv #52 called N=1, H=7, W=7, CI=512, FH=3, FW=3, CO=512, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [1.215] sent [14.9848] MB
~ 1.215 conv
Relu #95 on 25088 points, truncate=1 by 12 bits
Time in sec for current relu = 0.505
~ 0.505 relu
HomConv #53 called N=1, H=7, W=7, CI=512, FH=1, FW=1, CO=2048, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.943] sent [59.9109] MB
~ 2.943 conv
Truncate #18 on 100352 points by 12 bits
HomBN #14 via element-wise mult on 100352 points
Relu #97 on 100352 points, truncate=1 by 12 bits
Time in sec for current relu = 0.229
~ 0.229 relu
AvgPool 1 called N=1, H=1, W=1, C=2048, ksizeH=7, ksizeW=7
Time in sec for current avgpool = 0.029
~ 0.029 avgpool
Time in sec for current matmul = 0.172
~ 0.172 matmul
ArgMax 1 called, s1=1, s2=1001
Thread i = 0, total data sent till now = 1763412584
Thread i = 1, total data sent till now = 51414076
Thread i = 2, total data sent till now = 201876823
Thread i = 3, total data sent till now = 51414076
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 241357 milliseconds.
Total data sent = 1966.82 MiB.
Number of rounds = 1388
Total comm (sent+received) = 2802.25 MiB.
------------------------------------------------------
Total time in Conv = 104.477 seconds.
Total time in MatMul = 0.172 seconds.
Total time in BatchNorm = 3.798 seconds.
Total time in Truncation = 52.086 seconds.
Total time in Relu = 71.512 seconds.
Total time in MaxPool = 6.504 seconds.
Total time in AvgPool = 0.029 seconds.
Total time in ArgMax = 0.228 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 884.686 MiB.
MatMul data sent = 0.760652 MiB.
BatchNorm data sent = 169.774 MiB.
Truncation data sent = 172.698 MiB.
Relu data sent = 258.67 MiB.
Maxpool data sent = 44.5175 MiB.
Avgpool data sent = 0.644144 MiB.
ArgMax data sent = 0.0704584 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
Conv data (sent+received) = 1052.45 MiB.
MatMul data (sent+received) = 1.95122 MiB.
BatchNorm data (sent+received) = 359.684 MiB.
Truncation data (sent+received) = 345.396 MiB.
Relu data (sent+received) = 517.339 MiB.
Maxpool data (sent+received) = 89.035 MiB.
Avgpool data (sent+received) = 1.28829 MiB.
ArgMax data (sent+received) = 0.109762 MiB.
MatAdd data (sent+received) = 0 MiB.
MatAddBroadCast data (sent+received) = 0 MiB.
MulCir data (sent+received) = 0 MiB.
ScalarMul data (sent+received) = 0 MiB.
Sigmoid data (sent+received) = 0 MiB.
Tanh data (sent+received) = 0 MiB.
Sqrt data (sent+received) = 0 MiB.
NormaliseL2 data (sent+received) = 0 MiB.
