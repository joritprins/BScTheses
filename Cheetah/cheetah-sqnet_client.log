Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 831027
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomConv #1 called N=1, H=227, W=227, CI=3, FH=3, FW=3, CO=64, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [1.289] sent [2.85746] MB
~ 1.289 conv
expect 91848966 but got 91848967
expect -660114536 but got -660114535
expect 2777969943 but got 2777969942
expect 3225009 but got 3225008
[32mConvolution Output Matches[0m
Maxpool 1 called N=1, H=56, W=56, C=64, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 6.269
~ 6.269 maxpool
Relu #1 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 3.734
~ 3.734 relu
HomConv #2 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=16, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.1] sent [3.81024] MB
~ 0.1 conv
expect 1012703152 but got 1012703153
expect 1782522535 but got 1782522536
[32mConvolution Output Matches[0m
Relu #3 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.113
~ 0.113 relu
HomConv #3 called N=1, H=56, W=56, CI=16, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.091] sent [0.952525] MB
~ 0.091 conv
expect 1586098194 but got 1586098195
expect 1569485316 but got 1569485317
[32mConvolution Output Matches[0m
Relu #5 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.398
~ 0.398 relu
HomConv #4 called N=1, H=56, W=56, CI=16, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.256] sent [0.952358] MB
~ 0.256 conv
expect -2335710760 but got -2335710759
expect -629099184 but got -629099183
expect -608455384 but got -608455385
expect 801397947 but got 801397946
[32mConvolution Output Matches[0m
Relu #7 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.417
~ 0.417 relu
HomConv #5 called N=1, H=56, W=56, CI=128, FH=1, FW=1, CO=16, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.177] sent [7.6202] MB
~ 0.177 conv
expect 6072193578 but got 6072193579
expect 5842101225 but got 5842101226
expect 7669387221 but got 7669387220
[32mConvolution Output Matches[0m
Relu #9 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.112
~ 0.112 relu
HomConv #6 called N=1, H=56, W=56, CI=16, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.088] sent [0.952523] MB
~ 0.088 conv
expect -2955053739 but got -2955053738
expect -1420864639 but got -1420864638
expect 622646633 but got 622646632
expect 1526503489 but got 1526503488
[32mConvolution Output Matches[0m
Relu #11 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 3.665
~ 3.665 relu
HomConv #7 called N=1, H=56, W=56, CI=16, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.25] sent [0.952543] MB
~ 0.25 conv
expect -113995762 but got -113995761
expect 7482309088 but got 7482309089
expect -2054073444 but got -2054073445
expect 103555181 but got 103555180
[32mConvolution Output Matches[0m
Relu #13 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.441
~ 0.441 relu
Maxpool 2 called N=1, H=27, W=27, C=128, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 8.13
~ 8.13 maxpool
HomConv #8 called N=1, H=27, W=27, CI=128, FH=1, FW=1, CO=32, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.181] sent [1.5479] MB
~ 0.181 conv
expect 15173930 but got 15173931
expect 6851501573 but got 6851501574
[32mConvolution Output Matches[0m
Relu #15 on 23328 points, truncate=1 by 12 bits
Time in sec for current relu = 0.053
~ 0.053 relu
HomConv #9 called N=1, H=27, W=27, CI=32, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.221] sent [0.416735] MB
~ 0.221 conv
expect -3352300846 but got -3352300845
expect 2037439021 but got 2037439022
[32mConvolution Output Matches[0m
Relu #17 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.171
~ 0.171 relu
HomConv #10 called N=1, H=27, W=27, CI=32, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.244] sent [0.476282] MB
~ 0.244 conv
expect -3453309141 but got -3453309140
expect -1534829815 but got -1534829814
[32mConvolution Output Matches[0m
Relu #19 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.199
~ 0.199 relu
HomConv #11 called N=1, H=27, W=27, CI=256, FH=1, FW=1, CO=32, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.334] sent [3.09576] MB
~ 0.334 conv
expect 3557615380 but got 3557615381
expect 973296792 but got 973296793
[32mConvolution Output Matches[0m
Relu #21 on 23328 points, truncate=1 by 12 bits
Time in sec for current relu = 0.053
~ 0.053 relu
HomConv #12 called N=1, H=27, W=27, CI=32, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.218] sent [0.416762] MB
~ 0.218 conv
expect -4218745681 but got -4218745680
expect 317677453 but got 317677454
[32mConvolution Output Matches[0m
Relu #23 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.194
~ 0.194 relu
HomConv #13 called N=1, H=27, W=27, CI=32, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.255] sent [0.476247] MB
~ 0.255 conv
expect -548382936 but got -548382935
expect -2353659551 but got -2353659550
expect 1109673703 but got 1109673702
[32mConvolution Output Matches[0m
Relu #25 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.201
~ 0.201 relu
Maxpool 3 called N=1, H=13, W=13, C=256, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 3.979
~ 3.979 maxpool
HomConv #14 called N=1, H=13, W=13, CI=256, FH=1, FW=1, CO=48, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.13] sent [0.654792] MB
~ 0.13 conv
expect 2946652161 but got 2946652162
expect -1862497780 but got -1862497779
[32mConvolution Output Matches[0m
Relu #27 on 8112 points, truncate=1 by 12 bits
Time in sec for current relu = 0.022
~ 0.022 relu
HomConv #15 called N=1, H=13, W=13, CI=48, FH=1, FW=1, CO=192, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.178] sent [0.119081] MB
~ 0.178 conv
expect 520998270 but got 520998271
expect 57809404 but got 57809405
[32mConvolution Output Matches[0m
Relu #29 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.075
~ 0.075 relu
HomConv #16 called N=1, H=13, W=13, CI=48, FH=3, FW=3, CO=192, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.203] sent [0.178574] MB
~ 0.203 conv
expect -819884681 but got -819884680
expect -126478259 but got -126478258
[32mConvolution Output Matches[0m
Relu #31 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.071
~ 0.071 relu
HomConv #17 called N=1, H=13, W=13, CI=384, FH=1, FW=1, CO=48, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.176] sent [0.952428] MB
~ 0.176 conv
expect -1080612656 but got -1080612655
expect -240443792 but got -240443791
[32mConvolution Output Matches[0m
Relu #33 on 8112 points, truncate=1 by 12 bits
Time in sec for current relu = 0.022
~ 0.022 relu
HomConv #18 called N=1, H=13, W=13, CI=48, FH=1, FW=1, CO=192, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.169] sent [0.119085] MB
~ 0.169 conv
expect 462505175 but got 462505176
expect -34588490 but got -34588489
[32mConvolution Output Matches[0m
Relu #35 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.067
~ 0.067 relu
HomConv #19 called N=1, H=13, W=13, CI=48, FH=3, FW=3, CO=192, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.233] sent [0.178637] MB
~ 0.233 conv
expect -1772202821 but got -1772202820
expect -708318451 but got -708318450
[32mConvolution Output Matches[0m
Relu #37 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.075
~ 0.075 relu
HomConv #20 called N=1, H=13, W=13, CI=384, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.217] sent [0.952535] MB
~ 0.217 conv
expect 298034728 but got 298034729
expect -647181177 but got -647181176
[32mConvolution Output Matches[0m
Relu #39 on 10816 points, truncate=1 by 12 bits
Time in sec for current relu = 0.028
~ 0.028 relu
HomConv #21 called N=1, H=13, W=13, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.245] sent [0.178621] MB
~ 0.245 conv
expect -25515630 but got -25515629
expect 377689613 but got 377689614
[32mConvolution Output Matches[0m
Relu #41 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.091
~ 0.091 relu
HomConv #22 called N=1, H=13, W=13, CI=64, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.314] sent [0.23811] MB
~ 0.314 conv
expect -394196401 but got -394196400
expect 557464209 but got 557464210
[32mConvolution Output Matches[0m
Relu #43 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.096
~ 0.096 relu
HomConv #23 called N=1, H=13, W=13, CI=512, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.297] sent [1.30963] MB
~ 0.297 conv
expect 456895437 but got 456895438
expect 519136419 but got 519136420
[32mConvolution Output Matches[0m
Relu #45 on 10816 points, truncate=1 by 12 bits
Time in sec for current relu = 0.027
~ 0.027 relu
HomConv #24 called N=1, H=13, W=13, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.248] sent [0.178587] MB
~ 0.248 conv
expect -840514572 but got -840514571
expect -923899499 but got -923899498
[32mConvolution Output Matches[0m
Relu #47 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.097
~ 0.097 relu
HomConv #25 called N=1, H=13, W=13, CI=64, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.284] sent [0.238068] MB
~ 0.284 conv
expect -1739552162 but got -1739552161
expect -373176195 but got -373176194
[32mConvolution Output Matches[0m
Relu #49 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.097
~ 0.097 relu
HomConv #26 called N=1, H=13, W=13, CI=512, FH=1, FW=1, CO=1000, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [3.936] sent [1.30964] MB
~ 3.936 conv
expect 2019747 but got 2019748
expect 64167058 but got 64167059
[32mConvolution Output Matches[0m
Relu #51 on 169000 points, truncate=1 by 12 bits
Time in sec for current relu = 0.352
~ 0.352 relu
AvgPool 1 called N=1, H=1, W=1, C=1000, ksizeH=13, ksizeW=13
Time in sec for current avgpool = 0.026
~ 0.026 avgpool
ArgMax 1 called, s1=1, s2=1000
Thread i = 0, total data sent till now = 49420583
Thread i = 1, total data sent till now = 57901618
Thread i = 2, total data sent till now = 17626845
Thread i = 3, total data sent till now = 57904305
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 40785 milliseconds.
Total data sent = 168.651 MiB.
Number of rounds = 908
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 10.334 seconds.
Total time in MatMul = 0 seconds.
Total time in BatchNorm = 0 seconds.
Total time in Truncation = 0.096 seconds.
Total time in Relu = 10.871 seconds.
Total time in MaxPool = 18.378 seconds.
Total time in AvgPool = 0.026 seconds.
Total time in ArgMax = 0.006 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 31.1353 MiB.
MatMul data sent = 0 MiB.
BatchNorm data sent = 0 MiB.
Truncation data sent = 2.42572 MiB.
Relu data sent = 57.1657 MiB.
Maxpool data sent = 77.2877 MiB.
Avgpool data sent = 0.597395 MiB.
ArgMax data sent = 0.0393038 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
top-10 values from SqueezeNet
[31.7443848,30.9343262,30.3239746,28.5615234,28.1740723,27.8930664,27.7214355,27.6176758,27.5141602,27.2536621,]
predicted label = 248
