Using Eigen for Matmul
Doing BaseOT ...
using silent ot pack
using silent ot pack
using silent ot pack
using silent ot pack
After one-time setup, communication
Thread i = 0, total data sent till now = 830949
Thread i = 1, total data sent till now = 1726247
Thread i = 2, total data sent till now = 1726247
Thread i = 3, total data sent till now = 1726247
-----------Syncronizing-----------
secret_share_mod: 137438953472 bitlength: 37
backend: Ring-SilentOT-Cheetah
-----------Syncronized - now starting execution-----------
HomConv #1 called N=1, H=227, W=227, CI=3, FH=3, FW=3, CO=64, S=2, Padding VALID (0 0 0 0)
Time in sec for current conv = [2.388] sent [2.85767] MB
~ 2.388 conv
expect 47605244 but got 47605245
expect -27992124 but got -27992123
[32mConvolution Output Matches[0m
Maxpool 1 called N=1, H=56, W=56, C=64, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 10.271
~ 10.271 maxpool
Relu #1 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 4.527
~ 4.527 relu
HomConv #2 called N=1, H=56, W=56, CI=64, FH=1, FW=1, CO=16, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.328] sent [3.81047] MB
~ 0.328 conv
expect 1422672342 but got 1422672343
expect 131177136 but got 131177137
[32mConvolution Output Matches[0m
Relu #3 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.24
~ 0.24 relu
HomConv #3 called N=1, H=56, W=56, CI=16, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.196] sent [0.952688] MB
~ 0.196 conv
expect 983273433 but got 983273434
expect 1254705512 but got 1254705513
[32mConvolution Output Matches[0m
Relu #5 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.946
~ 0.946 relu
HomConv #4 called N=1, H=56, W=56, CI=16, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.422] sent [0.952571] MB
~ 0.422 conv
expect -3343567628 but got -3343567627
expect -945461681 but got -945461680
[32mConvolution Output Matches[0m
Relu #7 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.991
~ 0.991 relu
HomConv #5 called N=1, H=56, W=56, CI=128, FH=1, FW=1, CO=16, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.382] sent [7.62002] MB
~ 0.382 conv
expect 2589584329 but got 2589584330
expect 6477056884 but got 6477056885
[32mConvolution Output Matches[0m
Relu #9 on 50176 points, truncate=1 by 12 bits
Time in sec for current relu = 0.248
~ 0.248 relu
HomConv #6 called N=1, H=56, W=56, CI=16, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.209] sent [0.952405] MB
~ 0.209 conv
expect -733530417 but got -733530416
expect 429688848 but got 429688849
[32mConvolution Output Matches[0m
Relu #11 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 4.558
~ 4.558 relu
HomConv #7 called N=1, H=56, W=56, CI=16, FH=3, FW=3, CO=64, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.453] sent [0.952553] MB
~ 0.453 conv
expect 953092272 but got 953092273
expect 766227330 but got 766227331
[32mConvolution Output Matches[0m
Relu #13 on 200704 points, truncate=1 by 12 bits
Time in sec for current relu = 0.956
~ 0.956 relu
Maxpool 2 called N=1, H=27, W=27, C=128, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 9.888
~ 9.888 maxpool
HomConv #8 called N=1, H=27, W=27, CI=128, FH=1, FW=1, CO=32, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.413] sent [1.54764] MB
~ 0.413 conv
expect -1444428737 but got -1444428736
expect 2651843867 but got 2651843868
[32mConvolution Output Matches[0m
Relu #15 on 23328 points, truncate=1 by 12 bits
Time in sec for current relu = 0.122
~ 0.122 relu
HomConv #9 called N=1, H=27, W=27, CI=32, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.497] sent [0.416702] MB
~ 0.497 conv
expect 297702879 but got 297702880
expect 2778560262 but got 2778560263
[32mConvolution Output Matches[0m
Relu #17 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.449
~ 0.449 relu
HomConv #10 called N=1, H=27, W=27, CI=32, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.517] sent [0.476274] MB
~ 0.517 conv
expect 1427684981 but got 1427684982
expect -1567762359 but got -1567762358
[32mConvolution Output Matches[0m
Relu #19 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.457
~ 0.457 relu
HomConv #11 called N=1, H=27, W=27, CI=256, FH=1, FW=1, CO=32, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.481] sent [3.0958] MB
~ 0.481 conv
expect 4491933122 but got 4491933123
expect 2986635191 but got 2986635192
[32mConvolution Output Matches[0m
Relu #21 on 23328 points, truncate=1 by 12 bits
Time in sec for current relu = 0.158
~ 0.158 relu
HomConv #12 called N=1, H=27, W=27, CI=32, FH=1, FW=1, CO=128, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.386] sent [0.416723] MB
~ 0.386 conv
expect -765251948 but got -765251947
expect 2507954953 but got 2507954954
[32mConvolution Output Matches[0m
Relu #23 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.452
~ 0.452 relu
HomConv #13 called N=1, H=27, W=27, CI=32, FH=3, FW=3, CO=128, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.428] sent [0.476251] MB
~ 0.428 conv
expect -1159972071 but got -1159972070
expect -1872951728 but got -1872951727
[32mConvolution Output Matches[0m
Relu #25 on 93312 points, truncate=1 by 12 bits
Time in sec for current relu = 0.439
~ 0.439 relu
Maxpool 3 called N=1, H=13, W=13, C=256, ksizeH=3, ksizeW=3
Time in sec for current maxpool = 5.096
~ 5.096 maxpool
HomConv #14 called N=1, H=13, W=13, CI=256, FH=1, FW=1, CO=48, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.264] sent [0.654989] MB
~ 0.264 conv
expect 2946647313 but got 2946647314
expect -322101315 but got -322101314
[32mConvolution Output Matches[0m
Relu #27 on 8112 points, truncate=1 by 12 bits
Time in sec for current relu = 0.062
~ 0.062 relu
HomConv #15 called N=1, H=13, W=13, CI=48, FH=1, FW=1, CO=192, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.318] sent [0.119074] MB
~ 0.318 conv
expect 57813800 but got 57813801
expect -1249714642 but got -1249714641
[32mConvolution Output Matches[0m
Relu #29 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.171
~ 0.171 relu
HomConv #16 called N=1, H=13, W=13, CI=48, FH=3, FW=3, CO=192, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.432] sent [0.178602] MB
~ 0.432 conv
expect -1611137281 but got -1611137280
expect 1861204794 but got 1861204795
[32mConvolution Output Matches[0m
Relu #31 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.163
~ 0.163 relu
HomConv #17 called N=1, H=13, W=13, CI=384, FH=1, FW=1, CO=48, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.314] sent [0.952627] MB
~ 0.314 conv
expect 2229737119 but got 2229737120
expect 1503378291 but got 1503378292
[32mConvolution Output Matches[0m
Relu #33 on 8112 points, truncate=1 by 12 bits
Time in sec for current relu = 0.06
~ 0.06 relu
HomConv #18 called N=1, H=13, W=13, CI=48, FH=1, FW=1, CO=192, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.326] sent [0.119098] MB
~ 0.326 conv
expect 26195457 but got 26195458
expect -1777161771 but got -1777161770
[32mConvolution Output Matches[0m
Relu #35 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.17
~ 0.17 relu
HomConv #19 called N=1, H=13, W=13, CI=48, FH=3, FW=3, CO=192, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.438] sent [0.178591] MB
~ 0.438 conv
expect -1697023314 but got -1697023313
expect -768158582 but got -768158581
[32mConvolution Output Matches[0m
Relu #37 on 32448 points, truncate=1 by 12 bits
Time in sec for current relu = 0.168
~ 0.168 relu
HomConv #20 called N=1, H=13, W=13, CI=384, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.419] sent [0.952493] MB
~ 0.419 conv
expect 1613793182 but got 1613793183
expect -138642267 but got -138642266
[32mConvolution Output Matches[0m
Relu #39 on 10816 points, truncate=1 by 12 bits
Time in sec for current relu = 0.064
~ 0.064 relu
HomConv #21 called N=1, H=13, W=13, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.491] sent [0.178689] MB
~ 0.491 conv
expect 43562321 but got 43562322
expect 579084217 but got 579084218
[32mConvolution Output Matches[0m
Relu #41 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.214
~ 0.214 relu
HomConv #22 called N=1, H=13, W=13, CI=64, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.565] sent [0.238148] MB
~ 0.565 conv
expect -547044017 but got -547044016
expect -764865804 but got -764865803
[32mConvolution Output Matches[0m
Relu #43 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.218
~ 0.218 relu
HomConv #23 called N=1, H=13, W=13, CI=512, FH=1, FW=1, CO=64, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.397] sent [1.30961] MB
~ 0.397 conv
expect -1542425004 but got -1542425003
expect -677672171 but got -677672170
[32mConvolution Output Matches[0m
Relu #45 on 10816 points, truncate=1 by 12 bits
Time in sec for current relu = 0.082
~ 0.082 relu
HomConv #24 called N=1, H=13, W=13, CI=64, FH=1, FW=1, CO=256, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [0.437] sent [0.178635] MB
~ 0.437 conv
expect 754945751 but got 754945752
expect -999899622 but got -999899621
[32mConvolution Output Matches[0m
Relu #47 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.213
~ 0.213 relu
HomConv #25 called N=1, H=13, W=13, CI=64, FH=3, FW=3, CO=256, S=1, Padding SAME (1 1 1 1)
Time in sec for current conv = [0.51] sent [0.238148] MB
~ 0.51 conv
expect -891212866 but got -891212865
expect 3329760 but got 3329761
[32mConvolution Output Matches[0m
Relu #49 on 43264 points, truncate=1 by 12 bits
Time in sec for current relu = 0.221
~ 0.221 relu
HomConv #26 called N=1, H=13, W=13, CI=512, FH=1, FW=1, CO=1000, S=1, Padding VALID (0 0 0 0)
Time in sec for current conv = [4.643] sent [1.30974] MB
~ 4.643 conv
expect 40929734 but got 40929735
expect 29842463 but got 29842464
[32mConvolution Output Matches[0m
Relu #51 on 169000 points, truncate=1 by 12 bits
Time in sec for current relu = 0.785
~ 0.785 relu
AvgPool 1 called N=1, H=1, W=1, C=1000, ksizeH=13, ksizeW=13
Time in sec for current avgpool = 0.082
~ 0.082 avgpool
ArgMax 1 called, s1=1, s2=1000
Thread i = 0, total data sent till now = 49421436
Thread i = 1, total data sent till now = 57901618
Thread i = 2, total data sent till now = 17626845
Thread i = 3, total data sent till now = 57904305
------------------------------------------------------
------------------------------------------------------
------------------------------------------------------
Total time taken = 61172 milliseconds.
Total data sent = 168.652 MiB.
Number of rounds = 908
Total comm (sent+received) = (see SERVER OUTPUT)
------------------------------------------------------
Total time in Conv = 16.654 seconds.
Total time in MatMul = 0 seconds.
Total time in BatchNorm = 0 seconds.
Total time in Truncation = 0.358 seconds.
Total time in Relu = 17.134 seconds.
Total time in MaxPool = 25.255 seconds.
Total time in AvgPool = 0.082 seconds.
Total time in ArgMax = 0.114 seconds.
Total time in MatAdd = 0 seconds.
Total time in MatAddBroadCast = 0 seconds.
Total time in MulCir = 0 seconds.
Total time in ScalarMul = 0 seconds.
Total time in Sigmoid = 0 seconds.
Total time in Tanh = 0 seconds.
Total time in Sqrt = 0 seconds.
Total time in NormaliseL2 = 0 seconds.
------------------------------------------------------
Conv data sent = 31.1362 MiB.
MatMul data sent = 0 MiB.
BatchNorm data sent = 0 MiB.
Truncation data sent = 2.42572 MiB.
Relu data sent = 57.1657 MiB.
Maxpool data sent = 77.2877 MiB.
Avgpool data sent = 0.597395 MiB.
ArgMax data sent = 0.0393038 MiB.
MatAdd data sent = 0 MiB.
MatAddBroadCast data sent = 0 MiB.
MulCir data sent = 0 MiB.
Sigmoid data sent = 0 MiB.
Tanh data sent = 0 MiB.
Sqrt data sent = 0 MiB.
NormaliseL2 data sent = 0 MiB.
------------------------------------------------------
top-10 values from SqueezeNet
[31.7443848,30.9343262,30.3239746,28.5615234,28.1740723,27.8930664,27.7214355,27.6176758,27.5141602,27.2539062,]
predicted label = 248
